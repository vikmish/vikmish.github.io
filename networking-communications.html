<!DOCTYPE html><!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jun 13 2022 10:12:11 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="628e3d203d762f6dc00bb110" data-wf-site="618ca63aaa9959095805b23e">
<head>
  <meta charset="utf-8">
  <title>Networking &amp; Communications</title>
  <meta content="Networking &amp; Communications" property="og:title">
  <meta content="Networking &amp; Communications" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/mdef-8a5ceb.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Poppins:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic:devanagari,latin"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body class="body-3">
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-3 w-nav">
    <div class="container-8 w-container">
      <a href="index.html" class="w-nav-brand"><img src="images/Artboard-1.png" loading="lazy" width="140" sizes="(max-width: 767px) 132px, 140px" srcset="images/Artboard-1-p-500.png 500w, images/Artboard-1-p-800.png 800w, images/Artboard-1-p-1080.png 1080w, images/Artboard-1-p-1600.png 1600w, images/Artboard-1-p-2000.png 2000w, images/Artboard-1-p-2600.png 2600w, images/Artboard-1-p-3200.png 3200w, images/Artboard-1.png 5100w" alt="" class="image-13"></a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <a href="index.html" class="nav-text w-nav-link">MDEF<br></a>
        <link rel="prefetch" href="/">
        <a href="fab-academy.html" class="nav-text w-nav-link">Fab Academy</a>
        <link rel="prefetch" href="/fab-academy">
        <a href="wanderings.html" class="nav-text w-nav-link">Wanderings</a>
        <a href="contact.html" class="nav-text w-nav-link">Contact</a>
        <link rel="prefetch" href="/contact">
      </nav>
      <div class="w-nav-button">
        <div class="icon-2 w-icon-nav-menu"></div>
      </div>
    </div>
  </div>
  <div class="section wf-section">
    <div class="hero-image-box w-container"><img src="images/98A8640A-DDC6-4E05-ADCB-A5F4B917C38C.jpg" loading="lazy" sizes="(max-width: 479px) 88vw, (max-width: 767px) 93vw, (max-width: 991px) 94vw, (max-width: 1919px) 100vw, 1409px" srcset="images/98A8640A-DDC6-4E05-ADCB-A5F4B917C38C-p-500.jpeg 500w, images/98A8640A-DDC6-4E05-ADCB-A5F4B917C38C-p-800.jpeg 800w, images/98A8640A-DDC6-4E05-ADCB-A5F4B917C38C-p-1080.jpeg 1080w, images/98A8640A-DDC6-4E05-ADCB-A5F4B917C38C.jpg 1409w" alt="" class="landing-image">
      <p class="image-annotation">Screenshot taken from the NodeRED and MQTT dashboard</p>
    </div>
    <div class="hero-image-box w-container">
      <div class="term-annotation">WEEK X</div>
      <h1 class="project-page-h1">Networking &amp; Communications</h1>
      <h1 class="project-page-body-text">For the week, Ruben and I teamed up to extend the research on Duckweed from Term 1 to design a Distributed and Independent Monitoring System. The core aim was to monitor the health for the Duckweed plants so as that to grow them in a healthy and efficient way. This could be achieved by controlling the nutrition and strains of proteins  grown, for consumption in the later stage. The same system could be used my multiple individuals and multiple locations for any plants in any mediums be it aquatic plants, terrestrial plants or even aerial plants.<br><br>The first approach involved running Musquitto on a Raspberry Pi to serve as broker for the MQTT protocol, between the DigitalOcean server programmed on a ESP8266 micro-controller. Since ESP8266 has only one Analog pin, we would not read the phototransistor and temperature sensor at the same time. Therefore the decision to replace ESP8266 with an ESP32 was made. Certain pins were revised with the Wifi setup and MQTT communications. The code was re-run the with both sensor inputs at the same time. <br><br>The assembled code for the Arduino IDE sketch, consisting the Wifi, MQTT setup and commands for gathering data from various sensors, can be found below:<br></h1>
      <p class="code">                        #include<br>                        #include &quot;DHT.h&quot;<br>                        #define DHTPIN 21<br>                        #define DHTTYPE DHT11                        //Wifi setup<br>                        const char* ssid = &quot;Iaac-Wifi&quot;;<br>                        const char* password = &quot;EnterIaac22@&quot;;<br>                        const char* mqtt_server = &quot;167.99.44.189&quot;;                        <br>                        WiFiClient espClient;<br>                        PubSubClient client(espClient);<br>                        //Temperature probe setup<br>                        OneWire oneWire(14);<br>                        DallasTemperature tempSensor(&amp;oneWire);<br>                        float MT;<br>                        float MM;<br>                        const int DHTPin = 21;<br>                        const int lamp = 23;<br>                        // Initialize DHT sensor.<br>                        DHT dht(DHTPin, DHTTYPE);<br>                        // Timers auxiliar variables<br>                         long now = millis();<br>                         long lastMeasure = 0;                        <br>                        void setup_wifi() {<br>                          delay(10);<br>                          // We start by connecting to a WiFi network<br>                          Serial.println();<br>                          Serial.print(&quot;Connecting to &quot;);<br>                          Serial.println(ssid);<br>                          WiFi.begin(ssid, password);<br>                          while (WiFi.status() != WL_CONNECTED) {<br>                            delay(500);<br>                            Serial.print(&quot;.&quot;);<br>                          }<br>                          Serial.println(&quot;&quot;);<br>                          Serial.print(&quot;WiFi connected - ESP IP address: &quot;);<br>                          Serial.println(WiFi.localIP());<br>                        }                        <br>                          void callback(String topic, byte* message, unsigned int length) {<br>                          Serial.print(&quot;Message arrived on topic: &quot;);<br>                          Serial.print(topic);<br>                          Serial.print(&quot;. Message: &quot;);<br>                          String messageTemp;                          <br>                        for (int i = 0; i &lt; length; i++) {<br>                            Serial.print((char)message[i]);<br>                            messageTemp += (char)message[i];<br>                          }<br>‍<br>                          Serial.println();                          <br>                           if(topic==&quot;air/lamp&quot;){<br>                              Serial.print(&quot;Changing Room lamp to &quot;);<br>                              if(messageTemp == &quot;on&quot;){<br>                                digitalWrite(lamp, HIGH);<br>                                Serial.print(&quot;On&quot;);<br>                              }<br>                              else if(messageTemp == &quot;off&quot;){<br>                                digitalWrite(lamp, LOW);<br>                                Serial.print(&quot;Off&quot;);<br>                              }<br>                          }<br>                          Serial.println();<br>                        }<br>                        void reconnect() {<br>                          // Loop until we&#x27;re reconnected<br>                          while (!client.connected()) {<br>                            Serial.print(&quot;Attempting MQTT connection...&quot;);<br>                            // Attempt to connect                            if (client.connect(&quot;ESP8266Client&quot;)) {<br>                              Serial.println(&quot;connected&quot;);<br>                              // Subscribe or resubscribe to a topic<br>                              // You can subscribe to more topics (to control more LEDs in this example)<br>                              client.subscribe(&quot;air/lamp&quot;);<br>                            } else {<br>                              Serial.print(&quot;failed, rc=&quot;);<br>                              Serial.print(client.state());<br>                              Serial.println(&quot; try again in 5 seconds&quot;);<br>                              // Wait 5 seconds before retrying<br>                              delay(5000);<br>                            }<br>                          }<br>                        }                        <br>                          void setup() {<br>                          // LED output?<br>                          pinMode(lamp, OUTPUT);<br>                          dht.begin();<br>                          Serial.begin(115200);<br>                          setup_wifi();<br>                          client.setServer(mqtt_server, 1883);<br>                          client.setCallback(callback);<br>                          Serial.println(&quot;Dallas Temperature IC Control Library Demo&quot;);<br>                          //sensors.begin();<br>                        }<br>                        void loop() {<br>                          // Moisture Media Sensor<br>                              Serial.print(&quot;Moisture Sensor Value:&quot;);<br>                              Serial.println(analogRead(A3));<br>                              delay(100);<br>                              MM = analogRead(A3);                          // Phototransistor<br>                              int value = analogRead(33);<br>                              int perValue = map(value,0,1024,0,100);<br>                              Serial.println(&quot;Phototransistor: &quot;);<br>                              Serial.println(value);<br>                              delay(50);                          // Temperature Media probe<br>                              MT = tempSensor.getTempCByIndex(0);<br>                              tempSensor.requestTemperaturesByIndex(0);<br>                              Serial.print(&quot;Media Temperature: &quot;);<br>                              Serial.print(tempSensor.getTempCByIndex(0));<br>                              Serial.println(&quot; C&quot;);<br>                              delay(50);<br>‍<br>                            if (!client.connected())<br>                              reconnect();<br>                              client.loop();<br>                              long now = millis();<br>                              if (now - lastMeasure &gt; 50) {<br>                              lastMeasure = now;<br>                              float h = dht.readHumidity();<br>                              float t = dht.readTemperature();<br>                              float f = dht.readTemperature(true);                              // Check if any reads failed and exit early (to try again).<br>                              if (isnan(h) || isnan(t) || isnan(f)) {<br>‍<br>                              Serial.println(&quot;Failed to read from DHT sensor!&quot;);<br>                              return;<br>                              }                                         <br>                              <br>                              float hic = dht.computeHeatIndex(t, h, false);<br>                              static char temperatureTemp[7];<br>                              dtostrf(hic, 6, 2, temperatureTemp);<br>                              static char humidityTemp[7];<br>                              dtostrf(h, 6, 2, humidityTemp);<br>                              static char mediatemperatureTemp[7];<br>                              dtostrf(MT, 6, 2, mediatemperatureTemp);<br>                              static char mediamoistureMois[7];<br>                              dtostrf(MM, 6, 2, mediamoistureMois);<br>                              static char lightLight[7];<br>                              dtostrf(perValue, 6, 2, lightLight);                          // Publishes Temperature and Humidity values<br><br>                              client.publish(&quot;air/temperature&quot;, temperatureTemp);<br>                              client.publish(&quot;air/humidity&quot;, humidityTemp);<br>                              client.publish(&quot;media/temperature&quot;, mediatemperatureTemp);<br>                              client.publish(&quot;air/light&quot;, lightLight);<br>                              client.publish(&quot;media/moisture&quot;, mediamoistureMois);                              <br><br>                              Serial.print(&quot;Aerial Humidity: &quot;);<br>                              Serial.print(h);<br>                              Serial.print(&quot; %\t Aerial Temperature: &quot;);<br>                              Serial.print(t);<br>                              Serial.print(&quot; *C &quot;);<br>                              Serial.print(f);<br>                              Serial.print(&quot; *F\t Heat index: &quot;);<br>                              Serial.print(hic);<br>                              Serial.println(&quot; *C &quot;);<br>                              }<br>                        }</p><img src="images/setupduck.png" loading="lazy" sizes="(max-width: 479px) 88vw, (max-width: 767px) 93vw, (max-width: 991px) 94vw, (max-width: 1919px) 100vw, 1450px" srcset="images/setupduck-p-500.png 500w, images/setupduck-p-800.png 800w, images/setupduck-p-1080.png 1080w, images/setupduck.png 1462w" alt="" class="image-26">
      <p class="image-annotation">Fig. 10.1 The communications across servers and devices involved in the project.</p>
      <div class="w-layout-grid grid-11"></div>
    </div>
  </div>
  <footer id="footer" class="footer wf-section">
    <div class="w-container">
      <div class="footer-text"> Documentation for Master in Design for Emergent Futures © 2021</div>
    </div>
  </footer>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=618ca63aaa9959095805b23e" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>